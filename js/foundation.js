class l{static dragging=null;static grabbing=null;static elementStartClicked=null;static elementEndClicked=null;constructor(e,t,i){this.isVertical=e,this.element=t;e=i.querySelectorAll("img");this.negative=e[0],this.positive=e[1],this.start=null,this.trackShortcutClicks(),this.trackShortcutHover(),1e3<window.innerWidth?(this.trackDrag(),this.trackLeave()):console.log("not tracking")}trackShortcutClicks(){this.negative.addEventListener("click",()=>{this.element.scrollTo(0,0)}),this.positive.addEventListener("click",()=>{this.element.scrollTo(1e3,this.element.scrollHeight)})}trackShortcutHover(){this.negative.addEventListener("mouseenter",()=>{}),this.negative.addEventListener("mouseleave",()=>{}),this.positive.addEventListener("mouseenter",()=>{}),this.positive.addEventListener("mouseleave",()=>{})}trackDrag(){this.element.addEventListener("pointerdown",e=>{null==this.movingEventListener&&(this.movingEventListener=i=>{if(l.grabbing){l.dragging=!0;let e=null,t=null;this.isVertical?(e=i.clientY-this.start,t=this.element.scrollTop-e,this.element.scrollTo(0,t),this.start=i.clientY):(e=i.clientX-this.start,t=this.element.scrollLeft-e,this.element.scrollTo(t,0),this.start=i.clientX)}},this.element.addEventListener("pointermove",this.movingEventListener)),l.elementStartClicked=document.elementFromPoint(e.clientX,e.clientY),l.grabbing||(l.grabbing=!0,this.isVertical?this.start=e.clientY:this.start=e.clientX)}),this.element.addEventListener("scroll",()=>{this.revealScroll(this.negative,this.positive,this.element,this.isVertical)})}#recordDraggingStopped(e){l.dragging?(l.elementEndClicked=document.elementFromPoint(e.clientX,e.clientY),l.dragging=!1):l.elementEndClicked=null,l.grabbing=!1}trackLeave(){this.element.addEventListener("pointerleave",e=>{this.#recordDraggingStopped(e),this.element.removeEventListener("pointermove",this.movingEventListener),this.movingEventListener=void 0}),this.element.addEventListener("pointerup",e=>{this.#recordDraggingStopped(e),this.element.removeEventListener("pointermove",this.movingEventListener),this.movingEventListener=void 0})}revealScroll(){let e=null,t=null;t=this.isVertical?(e=this.element.scrollHeight-this.element.clientHeight,this.element.scrollTop):(e=this.element.scrollWidth-this.element.clientWidth,this.element.scrollLeft);var i=10*e/100,l=e-i;t>i?this.negative.classList.remove("hidden"):this.negative.classList.add("hidden"),t<l?this.positive.classList.remove("hidden"):this.positive.classList.add("hidden")}}let e=document.querySelector("#gallery-dimmer"),t=document.querySelector("#filter"),H=document.querySelector("#eye"),D=document.querySelector("#pupil");function i(e){let t=void 0;e.addEventListener("input",e=>{t&&(t.classList.remove("clicked"),t.classList.add("clickable"));e=e.target.nextElementSibling;e.classList.remove("clickable"),e.classList.add("clicked"),t=e})}document.addEventListener("click",e=>{});class F{constructor(e){this.element=e,this.x=null,this.y=null,this.element.classList.remove("hidden"),this.element.classList.remove("hidden"),this.width=this.element.clientWidth,this.height=this.element.clientHeight,this.blinked=!1,this.followReference=null}follow(){this.followReference=e=>{this.x=e.clientX,this.y=e.clientY,this.element.style.left=this.x-this.width/2+"px",this.element.style.top=this.y-this.height/2+"px"},document.addEventListener("mousemove",this.followReference)}halt(){document.removeEventListener("mousemove",this.followReference)}async blink(){this.blinked||(this.blinked=!0,this.addClass("blink"),await new Promise((e,t)=>{setTimeout(()=>{D.removeClass("blink"),this.blinked=!1,e()},500)}))}addClass(e){this.element.classList.add(e)}removeClass(e){this.element.classList.remove(e)}setOpacity(e=""){this.element.style.opacity=e}setBackground(e=""){this.element.style.background=e}}let n=document.querySelector("#export-actions"),X=(i(n),n.addEventListener("input",e=>{switch(e.target.id){case"contrast":case"brightness":case"vignette":document.querySelector("#export-slider").classList.remove("hidden"),v=e.target.id;var t=parseInt(document.querySelector("#metadata-"+e.target.id).innerText);m(o.value=t),W();break;default:console.log("not asking for slider")}}),i(document.querySelector("#export-actions")),document.querySelector("#export-slider")),r=X.querySelector("#slider-container input"),s=document.querySelector(".bar"),o=document.querySelector(".value"),Y="contrast",c=document.querySelector("#export-image"),a=100,d=100,u=100;function m(e=r.value){var t=r.min,i=r.max-t,l=s.clientWidth,e=(e-t)/i,t=r.getBoundingClientRect().width,i=e*(t-l),i=Math.max(0,Math.min(i,t-l));s.style.left=i+"px"}o.addEventListener("keydown",e=>{var t=parseInt(e.key);!Number.isNaN(t)&&o.value.length<3?console.log(t):"Backspace"==e.key||e.metaKey||e.shiftKey||-1<e.key.indexOf("Arrow")||(console.log("ERROR"),e.preventDefault())}),r.addEventListener("input",e=>{switch(m(),o.value=r.value,v){case"contrast":a=r.value,g.innerText=a;break;case"vignette":d=r.value;break;case"brightness":u=r.value,y.innerText=u}c.style.filter=`contrast(${a}%) brightness(${u}%)`});let h=document.querySelectorAll(".slider-images img"),J=(r.max-r.min)/h.length;function W(){let t=0;h.forEach(e=>{console.log(v),e.style.filter=`${v}(${t}%)`,t+=J})}let v=null,g=document.querySelector("#metadata-contrast"),y=document.querySelector("#metadata-brightness"),P=new MouseEvent("click"),V=(document.querySelector("#brightness").dispatchEvent(P),document.querySelector("#logo")),p=(V.addEventListener("click",()=>{R.classList.add("hidden"),a=100,g.innerText=a,d=100,u=100,y.innerText=u,r.value=100,o.value=100,m(),c.style.filter="",A.classList.remove("hidden")}),document.querySelector("#filter-button")),L=!0,f=(p.addEventListener("click",()=>{L?(M(),L=!1,B.negative.style.zIndex=0,document.querySelector("header").style.paddingBottom="0",document.querySelector("#filter-dimmer").classList.remove("hidden")):(q(),L=!0,B.negative.style.zIndex="",document.querySelector("header").style.paddingBottom="",document.querySelector("#filter-dimmer").classList.add("hidden")),e.classList.toggle("hidden"),t.classList.toggle("hidden"),z.revealScroll()}),new AbortController),S=f.signal,E=null,b=null,k=["feeling","location","gang","time"];async function q(){for(;;){var i=[];for(let t=0;t<4;t++){let e=t-1;e<0&&(e=3),i.push(k[e])}p.style.borderTopColor=`var(--${i[0]})`,p.style.borderRightColor=`var(--${i[1]})`,p.style.borderBottomColor=`var(--${i[2]})`,p.style.borderLeftColor=`var(--${i[3]})`,k=i;try{await new Promise((e,t)=>{E=()=>{t("aborted")},S.addEventListener("abort",E),b=setTimeout(()=>{S.removeEventListener("abort",E),e()},500)})}catch(e){return clearTimeout(b),"aborted"==e?void console.log("ABORTED"):void console.error(e)}finally{S.removeEventListener("abort",E)}}}function M(){f.abort(),f=new AbortController,S=f.signal,E=null}q();let z=new l(!1,document.querySelector("#filter-output"),document.querySelector("#filter-scroll")),w=document.querySelector("#filter-list"),x=void 0,C=void 0;function K(t){var e=JSON.parse(window.localStorage.getItem(C+"Filters"));t.classList.contains("output-option-selected")?e.splice(e.findIndex(e=>e==t.dataset.index),1):e.push(t.dataset.index),window.localStorage.setItem(C+"Filters",JSON.stringify(e)),t.classList.toggle("output-option-selected")}function T(e=!0){let t=void 0;for(var i of t=e?document.querySelectorAll("#filter-list label"):[document.querySelector("#filter-list .clicked")]){var l=i.getAttribute("for"),n=(i=l+"Filters",JSON.parse(window.localStorage.getItem(i)));if(console.log(n),n){for(var r of n)document.querySelector(`.${l}[data-index="${r}"]`).classList.remove("output-option-selected");window.localStorage.setItem(i,JSON.stringify([]))}}}i(w),w.addEventListener("input",e=>{C=e.target.id;e=document.querySelector("#filter-output-"+C);e.classList.remove("hidden"),x&&x.classList.add("hidden"),x=e}),document.querySelector("#gang").dispatchEvent(new MouseEvent("click")),document.querySelectorAll("#filter-output > section > div").forEach(t=>{t.addEventListener("click",e=>{K(t)})}),document.querySelectorAll("#filter-list label").forEach(e=>{var t=e.getAttribute("for");try{for(var i of JSON.parse(window.localStorage.getItem(t+"Filters")))document.querySelector(`.${t}[data-index="${i}"]`).classList.toggle("output-option-selected")}catch(e){window.localStorage.setItem(t+"Filters",JSON.stringify([]))}}),document.querySelector("#filter-reset-buttons").addEventListener("click",e=>{"BUTTON"==e.target.tagName&&(e.target.id?T(!1):T())});let A=document.querySelector("#gallery"),$=document.querySelector("#image-actions"),I=!1,N=null,U=(e.style.height=A.scrollHeight+"px",["green","grid","dead","carmox","black","mox","vr","pink"]);function O(){N&&(N.style.border="",N=void 0),I=!1,$.classList.add("hidden")}(async()=>{for(let i of U){let t=new Image;t.onload=()=>{for(var e of document.querySelectorAll(`[src="/cymages/p/${i}.webp"]`))e.src=t.src},t.src=`/cymages/p/${i}-high.png`}})(),A.querySelectorAll("img").forEach(t=>{let i=!1;t.addEventListener("click",e=>{N&&O(),l.elementEndClicked!=t&&(i=!i,(N=t).style.border="1px solid white",$.classList.remove("hidden"),I=!0,$.style.top=e.pageY-$.clientHeight/2+"px",$.style.left=e.pageX-$.clientWidth/2+"px")}),l.elementEndClicked=null}),$.addEventListener("pointerleave",e=>{O()});let j=!1,R=document.querySelector("#export"),B=($.querySelectorAll(".image-action").forEach(i=>{i.addEventListener("pointerdown",e=>{i.style.background="var(--white)",A.classList.add("hidden"),R.querySelector("#export-image").setAttribute("src",N.src),R.classList.remove("hidden"),B.negative.classList.add("hidden"),B.positive.classList.add("hidden"),m(),document.querySelectorAll(".slider-images img").forEach(e=>{e.setAttribute("src",N.src)}),i.style.background="";var t=new PointerEvent("pointerleave");$.dispatchEvent(t)})}),new l(!0,A,document.querySelector("#gallery-scroll")));B.revealScroll(),A.addEventListener("scroll",()=>{B.revealScroll()});