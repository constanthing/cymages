class l{static dragging=null;static grabbing=null;static elementStartClicked=null;static elementEndClicked=null;constructor(e,t,i){this.isVertical=e,this.element=t;e=i.querySelectorAll("img");this.negative=e[0],this.positive=e[1],this.start=null,this.trackShortcutClicks(),this.trackShortcutHover(),1e3<window.innerWidth?(this.trackDrag(),this.trackLeave()):console.log("not tracking")}trackShortcutClicks(){this.negative.addEventListener("click",()=>{this.element.scrollTo(0,0)}),this.positive.addEventListener("click",()=>{this.element.scrollTo(1e3,this.element.scrollHeight)})}trackShortcutHover(){this.negative.addEventListener("mouseenter",()=>{}),this.negative.addEventListener("mouseleave",()=>{}),this.positive.addEventListener("mouseenter",()=>{}),this.positive.addEventListener("mouseleave",()=>{})}trackDrag(){this.element.addEventListener("pointerdown",e=>{null==this.movingEventListener&&(this.movingEventListener=i=>{if(l.grabbing){l.dragging=!0;let e=null,t=null;this.isVertical?(e=i.clientY-this.start,t=this.element.scrollTop-e,this.element.scrollTo(0,t),this.start=i.clientY):(e=i.clientX-this.start,t=this.element.scrollLeft-e,this.element.scrollTo(t,0),this.start=i.clientX)}},this.element.addEventListener("pointermove",this.movingEventListener)),l.elementStartClicked=document.elementFromPoint(e.clientX,e.clientY),l.grabbing||(l.grabbing=!0,this.isVertical?this.start=e.clientY:this.start=e.clientX)}),this.element.addEventListener("scroll",()=>{this.revealScroll(this.negative,this.positive,this.element,this.isVertical)})}#recordDraggingStopped(e){l.dragging?(l.elementEndClicked=document.elementFromPoint(e.clientX,e.clientY),l.dragging=!1):l.elementEndClicked=null,l.grabbing=!1}trackLeave(){this.element.addEventListener("pointerleave",e=>{this.#recordDraggingStopped(e),this.element.removeEventListener("pointermove",this.movingEventListener),this.movingEventListener=void 0}),this.element.addEventListener("pointerup",e=>{this.#recordDraggingStopped(e),this.element.removeEventListener("pointermove",this.movingEventListener),this.movingEventListener=void 0})}revealScroll(){let e=null,t=null;t=this.isVertical?(e=this.element.scrollHeight-this.element.clientHeight,this.element.scrollTop):(e=this.element.scrollWidth-this.element.clientWidth,this.element.scrollLeft);var i=10*e/100,l=e-i;t>i?this.negative.classList.remove("hidden"):this.negative.classList.add("hidden"),t<l?this.positive.classList.remove("hidden"):this.positive.classList.add("hidden")}}let e=document.querySelector("#gallery-dimmer"),t=document.querySelector("#filter"),F=document.querySelector("#eye"),H=document.querySelector("#pupil");function D(e){let t=void 0;e.addEventListener("input",e=>{t&&(t.classList.remove("clicked"),t.classList.add("clickable"));e=e.target.nextElementSibling;e.classList.remove("clickable"),e.classList.add("clicked"),t=e})}document.addEventListener("click",e=>{});class J{constructor(e){this.element=e,this.x=null,this.y=null,this.element.classList.remove("hidden"),this.element.classList.remove("hidden"),this.width=this.element.clientWidth,this.height=this.element.clientHeight,this.blinked=!1,this.followReference=null}follow(){this.followReference=e=>{this.x=e.clientX,this.y=e.clientY,this.element.style.left=this.x-this.width/2+"px",this.element.style.top=this.y-this.height/2+"px"},document.addEventListener("mousemove",this.followReference)}halt(){document.removeEventListener("mousemove",this.followReference)}async blink(){this.blinked||(this.blinked=!0,this.addClass("blink"),await new Promise((e,t)=>{setTimeout(()=>{H.removeClass("blink"),this.blinked=!1,e()},500)}))}addClass(e){this.element.classList.add(e)}removeClass(e){this.element.classList.remove(e)}setOpacity(e=""){this.element.style.opacity=e}setBackground(e=""){this.element.style.background=e}}let s=document.querySelector("#export-image");class M{constructor(){this.buffer=[]}display(t){this.buffer.length&&this.hide(this.buffer[this.buffer.length-1]),t.classList.add("reveal"),-1==this.buffer.findIndex(e=>e==t)&&this.buffer.push(t),1<this.buffer.length&&y.classList.add("clickable")}back(){1<this.buffer.length&&(this.hide(this.buffer[this.buffer.length-1]),this.buffer.pop(),this.display(this.buffer[this.buffer.length-1]),1==this.buffer.length)&&y.classList.remove("clickable")}hide(e){e.classList.remove("reveal")}}let V=document.querySelector("#main-menu"),X=document.querySelector("#appearance"),r=document.querySelector("#slider"),n=document.querySelector("#custom-slider"),Y=document.querySelector("#slider > img"),o=n.querySelector("#slider-thumb"),a=r.querySelector("input[type='range']"),i=r.querySelector("#slider-RESET"),c=r.querySelector("#slider-SAVE"),d=void 0,P=document.querySelector("#framing"),W=document.querySelector("#metadata"),u=(document.querySelectorAll("[data-to]").forEach(i=>{i.addEventListener("click",e=>{var t=document.querySelector("#"+i.dataset.to);f.display(t),t==r?((d=i).dataset.value!=d.dataset.default?v(!0):v(!1),h(!1),g(),j(),G(),Y.src=d.querySelector("img").src):console.log("other")})}),r.querySelector("#slider-temp-value"));function j(){u.innerText=d.dataset.value;let e=0;for(var[t,i]of Object.entries(d.dataset))1<=e?document.querySelector("#slider-"+t).innerText=i:e+=1;a.setAttribute("max",parseInt(d.dataset.max)),a.setAttribute("min",parseInt(d.dataset.min)),a.value=d.dataset.value,m()}function m(){var e=n.getBoundingClientRect().width,t=o.getBoundingClientRect().width,i=(a.value-a.min)/a.max*(e-t),i=Math.max(0,Math.min(i,e-t));o.style.left=i+"px"}function h(e){e=(e=Boolean(e))?(c.classList.add("clickable"),"1"):(c.classList.remove("clickable"),""),d.dataset.saveclickable=e}function v(e){e?i.classList.add("clickable"):i.classList.remove("clickable"),d.dataset.resetclickable=e}a.addEventListener("input",()=>{d.dataset.value!=a.value?(v(!0),h(!0)):(v(!1),h(!1)),u.innerText=a.value,g(!0),m()}),c.addEventListener("click",()=>{d.dataset.value=a.value,document.querySelector("#slider-value").innerText=a.value,h(!1),g()}),i.addEventListener("click",()=>{d.dataset.value==d.dataset.default?h(!1):h(!0),v(!1),u.innerText=d.dataset.default,a.value=d.dataset.default,g(!0),m()});let z=document.querySelector("#slider-filter");function g(t=!1){let i="";var l;for(l of X.querySelectorAll("[data-to='slider']")){let e=void 0;e=(t&&l==d?a:l.dataset).value,i+=`${l.dataset.type}(${e+l.dataset.operator})`}z.innerText=i,s.style.filter=i}let U=document.querySelectorAll("#custom-slider .slider-images img");function G(){var e=d.dataset.max/5;let t=0;var i,l=d.dataset.type,s=d.dataset.operator;for(i of U)i.style.filter=`${l}(${t+s})`,t+=e}let f=new M,y=document.querySelector("#export-back"),K=(y.addEventListener("click",()=>{f.back(),g()}),f.display(V),document.querySelector("#logo")),Q=(K.addEventListener("click",()=>{N.classList.add("hidden"),contrast=100,contrastMetadata.innerText=contrast,vignette=100,brightness=100,brightnessMetadata.innerText=brightness,r.value=100,value.value=100,positionThumb(),s.style.filter="",$.classList.remove("hidden")}),new MouseEvent("click")),p=(document.querySelector("#filter-dimmer").addEventListener("click",()=>{L||p.dispatchEvent(Q)}),document.querySelector("#filter-button")),L=!0,S=(p.addEventListener("click",()=>{L?(Z(),L=!1,document.querySelector("header").style.paddingBottom="0",document.querySelector("header").style.zIndex="100",document.querySelector("#filter-dimmer").classList.remove("hidden")):(x(),L=!0,document.querySelector("header").style.paddingBottom="",document.querySelector("header").style.zIndex="",document.querySelector("#filter-dimmer").classList.add("hidden")),e.classList.toggle("hidden"),t.classList.toggle("hidden")}),new AbortController),b=S.signal,E=null,k=null,q=["feeling","location","gang","time"];async function x(){for(;;){var i=[];for(let t=0;t<4;t++){let e=t-1;e<0&&(e=3),i.push(q[e])}p.style.borderTopColor=`var(--${i[0]})`,p.style.borderRightColor=`var(--${i[1]})`,p.style.borderBottomColor=`var(--${i[2]})`,p.style.borderLeftColor=`var(--${i[3]})`,q=i;try{await new Promise((e,t)=>{E=()=>{t("aborted")},b.addEventListener("abort",E),k=setTimeout(()=>{b.removeEventListener("abort",E),e()},500)})}catch(e){return clearTimeout(k),"aborted"==e?void console.log("ABORTED"):void console.error(e)}finally{b.removeEventListener("abort",E)}}}function Z(){S.abort(),S=new AbortController,b=S.signal,E=null}x();let w=document.querySelector("#filter-list"),T=void 0,A=void 0;function _(t){var e=JSON.parse(window.localStorage.getItem(A+"Filters"));t.classList.contains("output-option-selected")?e.splice(e.findIndex(e=>e==t.dataset.index),1):e.push(t.dataset.index),window.localStorage.setItem(A+"Filters",JSON.stringify(e)),t.classList.toggle("output-option-selected")}function C(e=!0){let t=void 0;for(var i of t=e?document.querySelectorAll("#filter-list label"):[document.querySelector("#filter-list .clicked")]){var l=i.getAttribute("for"),s=(i=l+"Filters",JSON.parse(window.localStorage.getItem(i)));if(console.log(s),s){for(var r of s)document.querySelector(`.${l}[data-index="${r}"]`).classList.remove("output-option-selected");window.localStorage.setItem(i,JSON.stringify([]))}}}D(w),w.addEventListener("input",e=>{A=e.target.id;e=document.querySelector("#filter-output-"+A);e.classList.remove("hidden"),T&&T.classList.add("hidden"),T=e}),document.querySelector("#gang").dispatchEvent(new MouseEvent("click")),document.querySelectorAll("#filter-output > section > div").forEach(t=>{t.addEventListener("click",e=>{_(t)})}),document.querySelectorAll("#filter-list label").forEach(e=>{var t=e.getAttribute("for");try{for(var i of JSON.parse(window.localStorage.getItem(t+"Filters")))document.querySelector(`.${t}[data-index="${i}"]`).classList.toggle("output-option-selected")}catch(e){window.localStorage.setItem(t+"Filters",JSON.stringify([]))}}),document.querySelector("#filter-reset-buttons").addEventListener("click",e=>{"BUTTON"==e.target.tagName&&(e.target.id?C(!1):C())});let $=document.querySelector("#gallery"),ee=document.querySelector("#image-actions"),te=!1,I=null,ie=(e.style.height=$.scrollHeight+"px",["green","grid","dead","dead-2","carmox","black","mox","vr","pink"]);function O(e){return"0"==e.dataset.state?"play":"pause"}async function le(e,s){let t=e.dataset.index;for(t=null==t?0:parseInt(t);;){(t+=1)==e.children.length&&(t=0),console.log(t),e.children[t].click();try{await new Promise((e,t)=>{let i=()=>{clearTimeout(l),t("playSlideshow() aborted")},l=(s.addEventListener("abort",i),setTimeout(()=>{s.removeEventListener("abort",i),e()},750))})}catch(e){console.log(e);break}}e.dataset.index=t}(async()=>{for(let i of ie){let t=new Image;t.onload=()=>{for(var e of document.querySelectorAll(`[src="/cymages/p/${i}.webp"]`))e.removeAttribute("loading"),e.src=t.src},t.src=`/cymages/p/${i}-high.png`}})(),document.querySelectorAll(".photo-set-state").forEach(t=>{let i=new AbortController,l=i.signal;t.addEventListener("mouseenter",()=>{t.src=`/cymages/vectors/${O(t)}-fill.svg`}),t.addEventListener("mouseleave",()=>{t.src=`/cymages/vectors/${O(t)}-hollow.svg`}),t.addEventListener("click",()=>{var e=1==parseInt(t.dataset.state)?0:1;switch(e){case 0:i.abort(),i=new AbortController,l=i.signal;break;case 1:le(t.nextElementSibling,l)}t.dataset.state=e,t.src=`/cymages/vectors/${O(t)}-fill.svg`,t.dataset.fill="1"})}),document.querySelectorAll(".photo-set-links").forEach(t=>{var e=t.parentElement.parentElement;console.log(e);let i=e.querySelectorAll("figure");for(let e=0;e<i.length;e++){var l=document.createElement("input");l.dataset.index=e,l.setAttribute("type","radio"),l.setAttribute("name","photo-set-links"),l.classList.add("photo-set-link"),t.appendChild(l)}t.children[0].click();let s=0;t.addEventListener("input",e=>{i[s].classList.add("hidden");e=e.target.dataset.index;i[e].classList.remove("hidden"),s=e,t.dataset.index=s})});let B=document.querySelector(".ic-metadata"),se=document.querySelector("#ic-options");function re(){I&&(I.style.border="",I=void 0),te=!1,ee.classList.add("hidden")}$.querySelectorAll(".image-container").forEach(t=>{t.addEventListener("click",e=>{t.classList.add("clicked-gallery-image"),B.querySelector("#ic-title").innerText=t.dataset.title,B.querySelector("#ic-mood").innerText=t.dataset.mood,B.querySelector("#ic-time").innerText=t.dataset.time,B.querySelector("#ic-creator").innerText=t.dataset.creator,t.parentElement.classList.contains("photo-set")&&t.parentElement.querySelector(".photo-set-actions").classList.add("hidden"),t.appendChild(B),t.appendChild(se)}),t.addEventListener("mouseleave",()=>{t.classList.remove("clicked-gallery-image"),t.parentElement.classList.contains("photo-set")&&t.parentElement.querySelector(".photo-set-actions").classList.remove("hidden")})});let R=document.querySelector("#adjust-button"),N=document.querySelector("#export"),ne=document.querySelectorAll("#slider .slider-images img"),oe=document.querySelector("#export #logo");oe.addEventListener("click",()=>{N.classList.add("hidden")}),R.addEventListener("click",()=>{N.classList.remove("hidden"),s.src=R.parentElement.parentElement.querySelector("img").src;for(var e of ne)e.src=s.src});